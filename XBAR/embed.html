<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SlidesAI.io Presentation Generator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.11.0/dist/pptxgen.bundle.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f1a3d, #2a0c3d, #0f1a3d);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 0;
            background: rgba(15, 25, 60, 0.7);
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(106, 90, 205, 0.3);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(106, 90, 205, 0.3), transparent 70%);
            z-index: -1;
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            background: linear-gradient(to right, #6a5acd, #9370db);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            font-size: 1.2rem;
            color: #a0a0e0;
            max-width: 700px;
            margin: 0 auto 30px;
        }

        .main-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
        }

        .input-section {
            flex: 1;
            background: rgba(20, 25, 50, 0.7);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(106, 90, 205, 0.3);
        }

        .preview-section {
            flex: 1;
            background: rgba(20, 25, 50, 0.7);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(106, 90, 205, 0.3);
            display: flex;
            flex-direction: column;
        }

        .section-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .section-header h2 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: #9370db;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #a0a0e0;
        }

        input,
        textarea,
        select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(40, 40, 80, 0.5);
            border: 1px solid rgba(106, 90, 205, 0.3);
            border-radius: 8px;
            color: #fff;
            font-size: 1rem;
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        .btn {
            padding: 16px 40px;
            background: linear-gradient(45deg, #6a5acd, #9370db);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 5px 20px rgba(106, 90, 205, 0.5);
            width: 100%;
            justify-content: center;
        }

        .btn:hover {
            background: linear-gradient(45deg, #5a4acd, #8360db);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(106, 90, 205, 0.7);
        }

        .btn i {
            font-size: 1.2rem;
        }

        .multimedia-upload {
            border: 2px dashed rgba(106, 90, 205, 0.5);
            border-radius: 8px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .multimedia-upload:hover {
            border-color: #6a5acd;
            background: rgba(40, 40, 80, 0.3);
        }

        .multimedia-upload i {
            font-size: 3rem;
            color: #9370db;
            margin-bottom: 15px;
        }

        .multimedia-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }

        .preview-item {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            object-fit: cover;
            border: 2px solid #6a5acd;
            position: relative;
        }

        .preview-item.video::before {
            content: '\f144';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1.5rem;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }

        .preview-item.audio::before {
            content: '\f028';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1.5rem;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }

        .preview-container {
            flex: 1;
            background: #111;
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            min-height: 400px;
        }

        .slide-nav {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 15px;
        }

        .slide-nav-btn {
            background: rgba(40, 40, 80, 0.5);
            color: #ccc;
            border: none;
            border-radius: 8px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .slide-nav-btn:hover {
            background: linear-gradient(45deg, #6a5acd, #9370db);
            color: white;
        }

        .slide-counter {
            display: flex;
            align-items: center;
            font-size: 1rem;
            color: #a0a0e0;
        }

        .download-section {
            margin-top: 20px;
            text-align: center;
        }

        .save-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(40, 167, 69, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            transform: translateX(200%);
            transition: transform 0.3s ease;
        }

        .save-notification.show {
            transform: translateX(0);
        }

        .save-notification i {
            font-size: 1.5rem;
        }

        .generating-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 20, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        .generating-overlay.hidden {
            display: none;
        }

        .generating-overlay i {
            font-size: 3rem;
            color: #6a5acd;
            margin-bottom: 20px;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }

            100% {
                transform: scale(1);
            }
        }

        .preview-placeholder {
            text-align: center;
            color: #a0a0e0;
            padding: 20px;
        }

        .preview-placeholder i {
            font-size: 5rem;
            margin-bottom: 20px;
            color: #6a5acd;
        }

        .slide-svg {
            width: 100%;
            height: 100%;
            background-color: white;
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .template-item {
            height: 80px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            overflow: hidden;
            position: relative;
        }

        .template-item.active {
            border-color: #6a5acd;
            transform: scale(1.05);
        }

        .template-item .template-name {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            font-size: 0.7rem;
            padding: 3px;
            text-align: center;
        }

        .slide-content {
            position: relative;
            z-index: 2;
        }

        .slide-media {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .slide-media img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .slide-media video {
            max-width: 100%;
            max-height: 100%;
        }

        .slide-media iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .multimedia-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .url-input-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .url-input-group input {
            flex: 1;
        }

        .url-input-group button {
            padding: 10px 15px;
            background: #6a5acd;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        footer {
            text-align: center;
            padding: 40px 0 20px;
            margin-top: 40px;
            color: #a0a0e0;
            font-size: 0.9rem;
            border-top: 1px solid rgba(106, 90, 205, 0.3);
        }

        /* Template backgrounds */
        .professional-bg {
            background: linear-gradient(45deg, #1E3A8A, #3B82F6);
        }

        .creative-bg {
            background: linear-gradient(45deg, #6A5ACD, #9370DB);
        }

        .minimalist-bg {
            background: linear-gradient(45deg, #4B5563, #9CA3AF);
        }

        .tech-bg {
            background: linear-gradient(45deg, #0F766E, #14B8A6);
        }

        .macari-bg {
            background: linear-gradient(45deg, #FFFFFF, #FF0000);
        }

        .strategic-bg {
            background: linear-gradient(45deg, #0D47A1, #424242);
        }

        .crypto-bg {
            background: linear-gradient(45deg, #0f0c29, #302b63, #24243e);
        }

        .banking-bg {
            background: linear-gradient(45deg, #2c3e50, #4ca1af);
        }

        .sustainability-bg {
            background: linear-gradient(45deg, #1a2a6c, #b21f1f, #1a2a6c);
        }

        .pitch-bg {
            background: linear-gradient(45deg, #4776E6, #8E54E9);
        }

        .mobile-banking-bg {
            background: linear-gradient(45deg, #1D976C, #93F9B9);
        }

        .blockchain-bg {
            background: linear-gradient(45deg, #1e3c72, #2a5298);
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }

            h1 {
                font-size: 2.2rem;
            }

            .template-grid {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>SlidesAI.io Presentation Generator</h1>
            <p class="subtitle">Create stunning presentations with AI - Embed images, videos, and multimedia</p>
        </header>

        <div class="main-content">
            <div class="input-section">
                <div class="section-header">
                    <h2>Create Your Presentation</h2>
                    <p>Enter your content and let AI generate your slides</p>
                </div>

                <div class="form-group">
                    <label for="presentation-title"><i class="fas fa-heading"></i> Presentation Title</label>
                    <input type="text" id="presentation-title" placeholder="Enter presentation title"
                        value="Future of AI in Business">
                </div>

                <div class="form-group">
                    <label for="presentation-topic"><i class="fas fa-lightbulb"></i> Presentation Topic</label>
                    <textarea id="presentation-topic" placeholder="Describe what your presentation should be about">Slide Title: Lego-Styled Minimalist Apple Watch Concept
Slide Description: A centered 3D visual of a sleek, all-black Apple Watch rendered in a Lego-inspired aesthetic. The watch, facing forward, features a square screen and matching sport band—both finished in a glossy black that catches soft, even lighting. The stark black background enhances the premium design, emphasizing the product’s contours and texture. This modern, text-free composition captures the essence of minimalist sophistication, ideal for branding, concept design, or next-gen wearable showcases.
</textarea>
                </div>

                <div class="form-group">
                    <label for="slide-count"><i class="fas fa-layer-group"></i> Number of Slides</label>
                    <select id="slide-count">
                        <option value="5">5 Slides</option>
                        <option value="10" selected>10 Slides</option>
                        <option value="15">15 Slides</option>
                        <option value="20">20 Slides</option>
                    </select>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-palette"></i> Presentation Template</label>
                    <div class="template-grid" id="template-grid">
                        <div class="template-item professional-bg active" data-style="professional">
                            <div class="template-name">Professional</div>
                        </div>
                        <div class="template-item creative-bg" data-style="creative">
                            <div class="template-name">Creative</div>
                        </div>
                        <div class="template-item minimalist-bg" data-style="minimalist">
                            <div class="template-name">Minimalist</div>
                        </div>
                        <div class="template-item tech-bg" data-style="tech">
                            <div class="template-name">Tech</div>
                        </div>
                        <div class="template-item macari-bg" data-style="macari">
                            <div class="template-name">Macari</div>
                        </div>
                        <div class="template-item strategic-bg" data-style="strategic">
                            <div class="template-name">Strategic</div>
                        </div>
                        <div class="template-item crypto-bg" data-style="crypto">
                            <div class="template-name">Crypto</div>
                        </div>
                        <div class="template-item banking-bg" data-style="banking">
                            <div class="template-name">Banking</div>
                        </div>
                        <div class="template-item sustainability-bg" data-style="sustainability">
                            <div class="template-name">Sustainability</div>
                        </div>
                        <div class="template-item pitch-bg" data-style="pitch">
                            <div class="template-name">Pitch Deck</div>
                        </div>
                        <div class="template-item mobile-banking-bg" data-style="mobile-banking">
                            <div class="template-name">Mobile Banking</div>
                        </div>
                        <div class="template-item blockchain-bg" data-style="blockchain">
                            <div class="template-name">Blockchain</div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-photo-video"></i> Add Multimedia Resources</label>
                    <div class="multimedia-upload" id="multimedia-upload">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Drag & drop images/videos/audio here or click to browse</p>
                        <input type="file" id="file-input" accept="image/*,video/*,audio/*" multiple
                            style="display: none;">
                    </div>

                    <div class="multimedia-controls">
                        <div class="url-input-group">
                            <input type="text" id="media-url" placeholder="Paste image, video or audio URL">
                            <button id="add-url-btn">Add URL</button>
                        </div>
                    </div>

                    <div class="multimedia-preview" id="multimedia-preview"></div>
                </div>

                <button class="btn" id="generate-btn">
                    <i class="fas fa-magic"></i> Generate Presentation
                </button>
            </div>

            <div class="preview-section">
                <div class="section-header">
                    <h2>Presentation Preview</h2>
                    <p>Your AI-generated slides will appear here</p>
                </div>

                <div class="preview-container">
                    <div class="generating-overlay hidden" id="generating-overlay">
                        <i class="fas fa-spinner"></i>
                        <h3>Generating Your Presentation</h3>
                        <p>This usually takes 5-10 seconds...</p>
                    </div>

                    <div class="preview-placeholder" id="preview-placeholder">
                        <i class="fas fa-file-powerpoint"></i>
                        <h3>No Presentation Generated Yet</h3>
                        <p>Click "Generate Presentation" to create your slides</p>
                    </div>

                    <div id="slide-container" class="hidden">
                        <div class="slide-media" id="slide-media"></div>
                        <svg class="slide-svg" id="slide-svg" viewBox="0 0 800 450"></svg>
                    </div>
                </div>

                <div class="slide-nav">
                    <button class="slide-nav-btn" id="prev-slide">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="slide-counter">
                        <span id="current-slide">0</span> / <span id="total-slides">0</span>
                    </div>
                    <button class="slide-nav-btn" id="next-slide">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>

                <div class="download-section">
                    <button class="btn" id="download-btn">
                        <i class="fas fa-download"></i> Download Presentation
                    </button>
                </div>
            </div>
        </div>

        <div class="save-notification" id="save-notification">
            <i class="fas fa-check-circle"></i>
            <div>
                <h3>Presentation Saved!</h3>
                <p>Check your "Downloads" folder for the file</p>
            </div>
        </div>

        <footer>
            <p>Integrated SlidesAI.io Solution | Multimedia Presentation Generator</p>
            <p>© 2023 AI Presentation Tools. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // DOM Elements
        const multimediaUpload = document.getElementById('multimedia-upload');
        const fileInput = document.getElementById('file-input');
        const multimediaPreview = document.getElementById('multimedia-preview');
        const generateBtn = document.getElementById('generate-btn');
        const generatingOverlay = document.getElementById('generating-overlay');
        const previewPlaceholder = document.getElementById('preview-placeholder');
        const slideSvg = document.getElementById('slide-svg');
        const slideMedia = document.getElementById('slide-media');
        const prevSlideBtn = document.getElementById('prev-slide');
        const nextSlideBtn = document.getElementById('next-slide');
        const currentSlideEl = document.getElementById('current-slide');
        const totalSlidesEl = document.getElementById('total-slides');
        const downloadBtn = document.getElementById('download-btn');
        const saveNotification = document.getElementById('save-notification');
        const slideContainer = document.getElementById('slide-container');
        const templateItems = document.querySelectorAll('.template-item');
        const mediaUrlInput = document.getElementById('media-url');
        const addUrlBtn = document.getElementById('add-url-btn');

        // State
        let multimediaResources = [];
        let currentSlideIndex = 0;
        let generatedSlides = [];
        let presentationData = null;

        // Style templates with advanced layouts
        const styleTemplates = {
            professional: {
                bgColor: '#1E3A8A',
                titleColor: '#FFFFFF',
                textColor: '#FFFFFF',
                accentColor: '#3B82F6',
                font: 'Arial, sans-serif',
                titleSize: 36,
                textSize: 20,
                bulletColor: '#3B82F6',
                name: 'Professional',
                layout: 'header-footer',
                typography: 'sans-serif',
                graphics: 'minimal'
            },
            creative: {
                bgColor: '#6A5ACD',
                titleColor: '#FFFFFF',
                textColor: '#F0F8FF',
                accentColor: '#9370DB',
                font: 'Georgia, serif',
                titleSize: 40,
                textSize: 22,
                bulletColor: '#FFD700',
                name: 'Creative',
                layout: 'asymmetric',
                typography: 'serif',
                graphics: 'ornate'
            },
            minimalist: {
                bgColor: '#FFFFFF',
                titleColor: '#333333',
                textColor: '#555555',
                accentColor: '#4B5563',
                font: 'Helvetica, sans-serif',
                titleSize: 32,
                textSize: 18,
                bulletColor: '#9CA3AF',
                name: 'Minimalist',
                layout: 'clean',
                typography: 'sans-serif',
                graphics: 'none'
            },
            tech: {
                bgColor: '#0F172A',
                titleColor: '#0EA5E9',
                textColor: '#E2E8F0',
                accentColor: '#14B8A6',
                font: 'Consolas, monospace',
                titleSize: 34,
                textSize: 18,
                bulletColor: '#14B8A6',
                name: 'Tech',
                layout: 'grid',
                typography: 'monospace',
                graphics: 'tech'
            },
            macari: {
                bgColor: '#FFFFFF',
                titleColor: '#FF0000',
                textColor: '#000000',
                accentColor: '#FF0000',
                font: 'Montserrat, sans-serif',
                titleSize: 38,
                textSize: 20,
                bulletColor: '#FF0000',
                name: 'Macari Company',
                layout: 'corporate',
                typography: 'sans-serif',
                graphics: 'geometric'
            },
            strategic: {
                bgColor: '#0D47A1',
                titleColor: '#FFFFFF',
                textColor: '#E0E0E0',
                accentColor: '#424242',
                font: 'Roboto, sans-serif',
                titleSize: 34,
                textSize: 18,
                bulletColor: '#FFFFFF',
                name: 'Strategic Business',
                layout: 'master',
                typography: 'sans-serif',
                graphics: 'timeline'
            },
            crypto: {
                bgColor: '#0f0c29',
                titleColor: '#00d2ff',
                textColor: '#a8ff78',
                accentColor: '#302b63',
                font: 'Orbitron, sans-serif',
                titleSize: 36,
                textSize: 20,
                bulletColor: '#00d2ff',
                name: 'Crypto Theme',
                layout: 'dark-grid',
                typography: 'sans-serif',
                graphics: 'blockchain'
            },
            banking: {
                bgColor: '#2c3e50',
                titleColor: '#ecf0f1',
                textColor: '#bdc3c7',
                accentColor: '#4ca1af',
                font: 'Roboto, sans-serif',
                titleSize: 34,
                textSize: 18,
                bulletColor: '#4ca1af',
                name: 'Banking & Finance',
                layout: 'corporate',
                typography: 'sans-serif',
                graphics: 'financial'
            },
            sustainability: {
                bgColor: '#1a2a6c',
                titleColor: '#ffffff',
                textColor: '#e9f7ca',
                accentColor: '#b21f1f',
                font: 'Open Sans, sans-serif',
                titleSize: 36,
                textSize: 20,
                bulletColor: '#fdbb2d',
                name: 'Sustainability',
                layout: 'eco',
                typography: 'sans-serif',
                graphics: 'nature'
            },
            pitch: {
                bgColor: '#4776E6',
                titleColor: '#ffffff',
                textColor: '#f5f7fa',
                accentColor: '#8E54E9',
                font: 'Montserrat, sans-serif',
                titleSize: 38,
                textSize: 20,
                bulletColor: '#ffffff',
                name: 'Pitch Deck',
                layout: 'modern',
                typography: 'sans-serif',
                graphics: 'dynamic'
            },
            'mobile-banking': {
                bgColor: '#1D976C',
                titleColor: '#ffffff',
                textColor: '#e9f7ca',
                accentColor: '#93F9B9',
                font: 'Roboto, sans-serif',
                titleSize: 34,
                textSize: 18,
                bulletColor: '#93F9B9',
                name: 'Mobile Banking',
                layout: 'app',
                typography: 'sans-serif',
                graphics: 'mobile'
            },
            blockchain: {
                bgColor: '#1e3c72',
                titleColor: '#ffffff',
                textColor: '#a8ff78',
                accentColor: '#2a5298',
                font: 'Orbitron, sans-serif',
                titleSize: 36,
                textSize: 20,
                bulletColor: '#00d2ff',
                name: 'Blockchain',
                layout: 'tech-grid',
                typography: 'sans-serif',
                graphics: 'crypto'
            }
        };

        // Event Listeners
        multimediaUpload.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', (e) => {
            const files = e.target.files;
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                let type = 'image';

                if (file.type.startsWith('video/')) type = 'video';
                else if (file.type.startsWith('audio/')) type = 'audio';

                const reader = new FileReader();
                reader.onload = (event) => {
                    multimediaResources.push({
                        type: type,
                        source: event.target.result,
                        name: file.name,
                        id: 'media-' + Date.now() + Math.random().toString(36).substr(2, 5)
                    });
                    updateMultimediaPreview();
                };
                reader.readAsDataURL(file);
            }
        });

        addUrlBtn.addEventListener('click', () => {
            const url = mediaUrlInput.value.trim();
            if (!url) return;

            let type = 'image';
            if (url.match(/\.(mp4|webm|ogg|mov)$/i)) type = 'video';
            else if (url.match(/\.(mp3|wav|ogg)$/i)) type = 'audio';
            else if (url.match(/youtube\.com|youtu\.be/i)) type = 'youtube';

            multimediaResources.push({
                type: type,
                source: url,
                name: url.substring(url.lastIndexOf('/') + 1),
                id: 'url-' + Date.now() + Math.random().toString(36).substr(2, 5)
            });

            updateMultimediaPreview();
            mediaUrlInput.value = '';
        });

        generateBtn.addEventListener('click', generatePresentation);
        prevSlideBtn.addEventListener('click', showPrevSlide);
        nextSlideBtn.addEventListener('click', showNextSlide);
        downloadBtn.addEventListener('click', downloadPresentation);

        // Template selection
        templateItems.forEach(item => {
            item.addEventListener('click', () => {
                templateItems.forEach(i => i.classList.remove('active'));
                item.classList.add('active');
            });
        });

        // Functions
        function updateMultimediaPreview() {
            multimediaPreview.innerHTML = '';
            multimediaResources.forEach(resource => {
                const preview = document.createElement('div');
                preview.classList.add('preview-item', resource.type);

                if (resource.type === 'image') {
                    preview.style.backgroundImage = `url(${resource.source})`;
                    preview.style.backgroundSize = 'cover';
                    preview.style.backgroundPosition = 'center';
                } else {
                    preview.style.backgroundColor = '#6a5acd';
                }

                const removeBtn = document.createElement('div');
                removeBtn.innerHTML = '<i class="fas fa-times"></i>';
                removeBtn.style.position = 'absolute';
                removeBtn.style.top = '5px';
                removeBtn.style.right = '5px';
                removeBtn.style.cursor = 'pointer';
                removeBtn.style.color = 'white';
                removeBtn.style.backgroundColor = 'rgba(0,0,0,0.5)';
                removeBtn.style.borderRadius = '50%';
                removeBtn.style.width = '20px';
                removeBtn.style.height = '20px';
                removeBtn.style.display = 'flex';
                removeBtn.style.justifyContent = 'center';
                removeBtn.style.alignItems = 'center';

                removeBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const index = multimediaResources.findIndex(r => r.id === resource.id);
                    if (index !== -1) {
                        multimediaResources.splice(index, 1);
                        updateMultimediaPreview();
                    }
                });

                preview.appendChild(removeBtn);
                multimediaPreview.appendChild(preview);
            });
        }

        function generatePresentation() {
            // Get form values
            const title = document.getElementById('presentation-title').value;
            const topic = document.getElementById('presentation-topic').value;
            const slideCount = parseInt(document.getElementById('slide-count').value);
            const activeTemplate = document.querySelector('.template-item.active');
            const style = activeTemplate ? activeTemplate.dataset.style : 'professional';

            // Validate input
            if (!title.trim() || !topic.trim()) {
                alert('Please enter a title and topic for your presentation');
                return;
            }

            // Show generating overlay
            generatingOverlay.classList.remove('hidden');
            previewPlaceholder.classList.add('hidden');
            slideContainer.classList.add('hidden');

            // Generate presentation structure
            presentationData = generatePresentationStructure(title, topic, slideCount, style);

            // Simulate processing time
            setTimeout(() => {
                generatedSlides = presentationData.slides;

                // Update UI
                generatingOverlay.classList.add('hidden');
                previewPlaceholder.classList.add('hidden');
                slideContainer.classList.remove('hidden');

                // Show first slide
                currentSlideIndex = 0;
                updateSlideDisplay();

                // Update slide counter
                totalSlidesEl.textContent = generatedSlides.length;
            }, 1500);
        }

        function generatePresentationStructure(title, topic, slideCount, style) {
            // Generate slide content based on topic
            const slides = [];

            // Title slide
            slides.push({
                title: title,
                content: [
                    `Topic: ${topic}`,
                    `Generated on: ${new Date().toLocaleDateString()}`,
                    "Created with SlidesAI.io"
                ],
                type: "title",
                style: style,
                media: multimediaResources.length > 0 ? multimediaResources[0] : null
            });

            // Content slides with different layouts
            const contentPoints = [
                "Introduction to the topic",
                "Key concepts and definitions",
                "Current trends and developments",
                "Benefits and advantages",
                "Challenges and limitations",
                "Case studies and examples",
                "Implementation strategies",
                "Future outlook and predictions",
                "Recommendations and best practices",
                "Conclusion and summary"
            ];

            for (let i = 1; i < slideCount; i++) {
                const slideTitle = contentPoints[Math.min(i - 1, contentPoints.length - 1)];
                const content = generateSlideContent(topic, slideTitle, i);

                // Determine slide type based on position
                let slideType = "content";
                if (i === 1) slideType = "section-header";
                else if (i === slideCount - 1) slideType = "conclusion";
                else if (i % 3 === 0) slideType = "infographic";
                else if (i % 4 === 0) slideType = "timeline";
                else if (i % 5 === 0) slideType = "team";

                // Assign media resource to slide (round-robin)
                const mediaIndex = i % multimediaResources.length;
                const media = multimediaResources.length > 0 ? multimediaResources[mediaIndex] : null;

                slides.push({
                    title: slideTitle,
                    content: content,
                    type: slideType,
                    style: style,
                    media: media
                });
            }

            return {
                title: title,
                topic: topic,
                slides: slides,
                style: style,
                generatedAt: new Date()
            };
        }

        function generateSlideContent(topic, slideTitle, slideIndex) {
            const contentPoints = [];
            const pointCount = 3 + Math.floor(Math.random() * 3); // 3-5 points

            for (let i = 0; i < pointCount; i++) {
                contentPoints.push(generateContentPoint(topic, slideTitle, slideIndex, i));
            }

            return contentPoints;
        }

        function generateContentPoint(topic, slideTitle, slideIndex, pointIndex) {
            const verbs = ["Implement", "Develop", "Utilize", "Optimize", "Streamline", "Enhance", "Transform"];
            const nouns = ["processes", "systems", "solutions", "strategies", "technologies", "approaches", "frameworks"];
            const adjectives = ["AI-driven", "efficient", "scalable", "innovative", "robust", "adaptive", "intelligent"];

            const verb = verbs[Math.floor(Math.random() * verbs.length)];
            const noun = nouns[Math.floor(Math.random() * nouns.length)];
            const adjective = adjectives[Math.floor(Math.random() * adjectives.length)];

            return `${verb} ${adjective} ${noun} for ${topic.toLowerCase()} ${pointIndex % 2 === 0 ? 'improves outcomes' : 'reduces costs'}`;
        }

        function updateSlideDisplay() {
            if (generatedSlides.length === 0) return;

            const slide = generatedSlides[currentSlideIndex];
            const style = styleTemplates[slide.style] || styleTemplates.professional;
            slideSvg.innerHTML = '';
            slideMedia.innerHTML = '';

            // Create SVG slide background
            const bg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            bg.setAttribute('width', '100%');
            bg.setAttribute('height', '100%');
            bg.setAttribute('fill', style.bgColor);
            slideSvg.appendChild(bg);

            // Template-specific decorative elements
            if (slide.style === 'professional') {
                // Professional template design
                const accentBar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                accentBar.setAttribute('x', '0');
                accentBar.setAttribute('y', '0');
                accentBar.setAttribute('width', '100%');
                accentBar.setAttribute('height', '15');
                accentBar.setAttribute('fill', style.accentColor);
                slideSvg.appendChild(accentBar);

                const footerBar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                footerBar.setAttribute('x', '0');
                footerBar.setAttribute('y', '435');
                footerBar.setAttribute('width', '100%');
                footerBar.setAttribute('height', '15');
                footerBar.setAttribute('fill', style.accentColor);
                slideSvg.appendChild(footerBar);
            }
            else if (slide.style === 'creative') {
                // Creative template design
                const circle1 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle1.setAttribute('cx', '700');
                circle1.setAttribute('cy', '50');
                circle1.setAttribute('r', '50');
                circle1.setAttribute('fill', style.accentColor);
                circle1.setAttribute('opacity', '0.3');
                slideSvg.appendChild(circle1);

                const circle2 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle2.setAttribute('cx', '50');
                circle2.setAttribute('cy', '400');
                circle2.setAttribute('r', '70');
                circle2.setAttribute('fill', style.accentColor);
                circle2.setAttribute('opacity', '0.2');
                slideSvg.appendChild(circle2);
            }
            else if (slide.style === 'tech') {
                // Tech template design
                for (let i = 0; i < 20; i++) {
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    const x1 = Math.random() * 800;
                    const y1 = Math.random() * 450;
                    const x2 = x1 + (Math.random() * 100 - 50);
                    const y2 = y1 + (Math.random() * 100 - 50);
                    line.setAttribute('x1', x1);
                    line.setAttribute('y1', y1);
                    line.setAttribute('x2', x2);
                    line.setAttribute('y2', y2);
                    line.setAttribute('stroke', style.accentColor);
                    line.setAttribute('stroke-width', '0.5');
                    line.setAttribute('opacity', '0.2');
                    slideSvg.appendChild(line);
                }
            }
            else if (slide.style === 'macari') {
                // Macari template design
                const accentBar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                accentBar.setAttribute('x', '0');
                accentBar.setAttribute('y', '0');
                accentBar.setAttribute('width', '100%');
                accentBar.setAttribute('height', '10');
                accentBar.setAttribute('fill', style.accentColor);
                slideSvg.appendChild(accentBar);

                const footerBar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                footerBar.setAttribute('x', '0');
                footerBar.setAttribute('y', '440');
                footerBar.setAttribute('width', '100%');
                footerBar.setAttribute('height', '10');
                footerBar.setAttribute('fill', style.accentColor);
                slideSvg.appendChild(footerBar);

                // Add geometric elements for Macari style
                const rect1 = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect1.setAttribute('x', '650');
                rect1.setAttribute('y', '50');
                rect1.setAttribute('width', '100');
                rect1.setAttribute('height', '100');
                rect1.setAttribute('fill', style.accentColor);
                rect1.setAttribute('opacity', '0.1');
                slideSvg.appendChild(rect1);
            }
            else if (slide.style === 'strategic') {
                // Strategic template design
                const wave = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                wave.setAttribute('d', 'M0,100 Q150,50 300,100 T600,100 T800,50 L800,450 L0,450 Z');
                wave.setAttribute('fill', style.accentColor);
                wave.setAttribute('opacity', '0.15');
                slideSvg.appendChild(wave);

                // Add subtle grid lines
                for (let i = 0; i < 5; i++) {
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', '0');
                    line.setAttribute('y1', 90 + i * 80);
                    line.setAttribute('x2', '800');
                    line.setAttribute('y2', 90 + i * 80);
                    line.setAttribute('stroke', style.textColor);
                    line.setAttribute('stroke-width', '0.5');
                    line.setAttribute('opacity', '0.1');
                    slideSvg.appendChild(line);
                }
            }
            else if (slide.style === 'crypto') {
                // Crypto template design
                const circle1 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle1.setAttribute('cx', '50');
                circle1.setAttribute('cy', '50');
                circle1.setAttribute('r', '40');
                circle1.setAttribute('fill', style.accentColor);
                circle1.setAttribute('opacity', '0.2');
                slideSvg.appendChild(circle1);

                const circle2 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle2.setAttribute('cx', '750');
                circle2.setAttribute('cy', '400');
                circle2.setAttribute('r', '60');
                circle2.setAttribute('fill', style.accentColor);
                circle2.setAttribute('opacity', '0.2');
                slideSvg.appendChild(circle2);

                // Add blockchain nodes
                for (let i = 0; i < 8; i++) {
                    const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                    rect.setAttribute('x', 100 + i * 20);
                    rect.setAttribute('y', 350);
                    rect.setAttribute('width', '10');
                    rect.setAttribute('height', '10');
                    rect.setAttribute('fill', style.bulletColor);
                    rect.setAttribute('opacity', '0.5');
                    slideSvg.appendChild(rect);
                }
            }
            else if (slide.style === 'banking') {
                // Banking template design
                const wave = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                wave.setAttribute('d', 'M0,150 C150,100 350,200 500,150 C650,100 750,250 800,200 L800,450 L0,450 Z');
                wave.setAttribute('fill', style.accentColor);
                wave.setAttribute('opacity', '0.2');
                slideSvg.appendChild(wave);

                // Add coins
                for (let i = 0; i < 5; i++) {
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttribute('cx', 700 - i * 40);
                    circle.setAttribute('cy', 50);
                    circle.setAttribute('r', '20');
                    circle.setAttribute('fill', style.titleColor);
                    circle.setAttribute('opacity', '0.1');
                    slideSvg.appendChild(circle);
                }
            }

            // Add title based on slide type
            const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            title.setAttribute('font-size', style.titleSize);
            title.setAttribute('font-weight', 'bold');
            title.setAttribute('fill', style.titleColor);
            title.setAttribute('font-family', style.font);
            title.textContent = slide.title;

            if (slide.type === "title") {
                title.setAttribute('x', '400');
                title.setAttribute('y', '150');
                title.setAttribute('text-anchor', 'middle');
                slideSvg.appendChild(title);
            }
            else if (slide.type === "section-header") {
                // Section header with accent bar
                const accentBar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                accentBar.setAttribute('x', '0');
                accentBar.setAttribute('y', '80');
                accentBar.setAttribute('width', '800');
                accentBar.setAttribute('height', '5');
                accentBar.setAttribute('fill', style.accentColor);
                slideSvg.appendChild(accentBar);

                title.setAttribute('x', '50');
                title.setAttribute('y', '70');
                slideSvg.appendChild(title);
            }
            else {
                title.setAttribute('x', '50');
                title.setAttribute('y', '80');
                slideSvg.appendChild(title);
            }

            // Add content based on slide type
            if (slide.type === "infographic") {
                // Create infographic layout
                const infographic = document.createElementNS('http://www.w3.org/2000/svg', 'g');

                // Create circles representing data points
                for (let i = 0; i < slide.content.length; i++) {
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    const cx = 200 + i * 150;
                    const cy = 250;
                    const r = 40 + i * 5;

                    circle.setAttribute('cx', cx);
                    circle.setAttribute('cy', cy);
                    circle.setAttribute('r', r);
                    circle.setAttribute('fill', style.accentColor);
                    circle.setAttribute('opacity', '0.5');
                    infographic.appendChild(circle);

                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', cx);
                    text.setAttribute('y', cy);
                    text.setAttribute('text-anchor', 'middle');
                    text.setAttribute('dominant-baseline', 'middle');
                    text.setAttribute('fill', style.textColor);
                    text.setAttribute('font-size', '20');
                    text.textContent = slide.content[i].substring(0, 3);
                    infographic.appendChild(text);

                    const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    label.setAttribute('x', cx);
                    label.setAttribute('y', cy + 60);
                    label.setAttribute('text-anchor', 'middle');
                    label.setAttribute('fill', style.textColor);
                    label.setAttribute('font-size', '16');
                    label.textContent = slide.content[i].substring(0, 20) + (slide.content[i].length > 20 ? '...' : '');
                    infographic.appendChild(label);
                }

                slideSvg.appendChild(infographic);
            }
            else if (slide.type === "timeline") {
                // Create timeline layout
                const timeline = document.createElementNS('http://www.w3.org/2000/svg', 'g');

                // Timeline line
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', '100');
                line.setAttribute('y1', '250');
                line.setAttribute('x2', '700');
                line.setAttribute('y2', '250');
                line.setAttribute('stroke', style.accentColor);
                line.setAttribute('stroke-width', '3');
                timeline.appendChild(line);

                // Timeline points
                for (let i = 0; i < slide.content.length; i++) {
                    const x = 100 + (i * 600 / (slide.content.length - 1));

                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttribute('cx', x);
                    circle.setAttribute('cy', '250');
                    circle.setAttribute('r', '15');
                    circle.setAttribute('fill', style.bulletColor);
                    timeline.appendChild(circle);

                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', x);
                    text.setAttribute('y', '200');
                    text.setAttribute('text-anchor', 'middle');
                    text.setAttribute('fill', style.textColor);
                    text.setAttribute('font-size', '16');
                    text.textContent = `Step ${i + 1}`;
                    timeline.appendChild(text);

                    const content = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    content.setAttribute('x', x);
                    content.setAttribute('y', '290');
                    content.setAttribute('text-anchor', 'middle');
                    content.setAttribute('fill', style.textColor);
                    content.setAttribute('font-size', '14');
                    content.textContent = slide.content[i].substring(0, 20) + (slide.content[i].length > 20 ? '...' : '');
                    timeline.appendChild(content);
                }

                slideSvg.appendChild(timeline);
            }
            else if (slide.type === "team") {
                // Team profile layout
                const team = document.createElementNS('http://www.w3.org/2000/svg', 'g');

                // Create team member profiles
                for (let i = 0; i < Math.min(slide.content.length, 4); i++) {
                    const x = 150 + (i % 2) * 300;
                    const y = 150 + Math.floor(i / 2) * 150;

                    // Profile circle
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttribute('cx', x);
                    circle.setAttribute('cy', y);
                    circle.setAttribute('r', '40');
                    circle.setAttribute('fill', style.accentColor);
                    circle.setAttribute('opacity', '0.7');
                    team.appendChild(circle);

                    // Name
                    const name = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    name.setAttribute('x', x);
                    name.setAttribute('y', y + 60);
                    name.setAttribute('text-anchor', 'middle');
                    name.setAttribute('fill', style.textColor);
                    name.setAttribute('font-size', '16');
                    name.textContent = `Member ${i + 1}`;
                    team.appendChild(name);

                    // Role
                    const role = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    role.setAttribute('x', x);
                    role.setAttribute('y', y + 85);
                    role.setAttribute('text-anchor', 'middle');
                    role.setAttribute('fill', style.textColor);
                    role.setAttribute('font-size', '14');
                    role.textContent = slide.content[i].substring(0, 20) + (slide.content[i].length > 20 ? '...' : '');
                    team.appendChild(role);
                }

                slideSvg.appendChild(team);
            }
            else {
                // Standard content layout
                slide.content.forEach((point, index) => {
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', slide.type === "title" ? '400' : '70');
                    text.setAttribute('y', slide.type === "title" ? (200 + index * 40) : (130 + index * 40));
                    text.setAttribute('font-size', style.textSize);
                    text.setAttribute('fill', style.textColor);
                    text.setAttribute('font-family', style.font);

                    // Center content on title slide
                    if (slide.type === "title") {
                        text.setAttribute('text-anchor', 'middle');
                    }

                    // Add bullet point (not on title slide)
                    if (slide.type !== "title" && slide.type !== "section-header") {
                        const bullet = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                        bullet.setAttribute('cx', '55');
                        bullet.setAttribute('cy', 130 + index * 40 - 5);
                        bullet.setAttribute('r', '5');
                        bullet.setAttribute('fill', style.bulletColor);
                        slideSvg.appendChild(bullet);
                    }

                    text.textContent = slide.type === "title" ? point : `• ${point}`;
                    slideSvg.appendChild(text);
                });
            }

            // Add footer
            const footer = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            footer.setAttribute('x', '700');
            footer.setAttribute('y', '430');
            footer.setAttribute('font-size', '16');
            footer.setAttribute('fill', style.textColor);
            footer.setAttribute('font-family', style.font);
            footer.textContent = `Slide ${currentSlideIndex + 1} of ${generatedSlides.length}`;
            slideSvg.appendChild(footer);

            // Add logo for title slide
            if (slide.type === "title") {
                const logo = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                logo.setAttribute('x', '400');
                logo.setAttribute('y', '400');
                logo.setAttribute('font-size', '24');
                logo.setAttribute('fill', style.textColor);
                logo.setAttribute('font-family', style.font);
                logo.setAttribute('text-anchor', 'middle');
                logo.textContent = "SlidesAI.io";
                slideSvg.appendChild(logo);
            }

            // Add media to slide
            if (slide.media) {
                if (slide.media.type === 'image') {
                    const img = document.createElement('img');
                    img.src = slide.media.source;
                    img.style.maxWidth = '100%';
                    img.style.maxHeight = '100%';
                    slideMedia.appendChild(img);
                } else if (slide.media.type === 'video') {
                    const video = document.createElement('video');
                    video.src = slide.media.source;
                    video.controls = true;
                    video.style.maxWidth = '100%';
                    video.style.maxHeight = '100%';
                    slideMedia.appendChild(video);
                } else if (slide.media.type === 'audio') {
                    const audio = document.createElement('audio');
                    audio.src = slide.media.source;
                    audio.controls = true;
                    audio.style.maxWidth = '100%';
                    slideMedia.appendChild(audio);
                } else if (slide.media.type === 'youtube') {
                    const videoId = extractYouTubeId(slide.media.source);
                    if (videoId) {
                        const iframe = document.createElement('iframe');
                        iframe.src = `https://www.youtube.com/embed/${videoId}`;
                        iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
                        iframe.allowFullscreen = true;
                        iframe.style.width = '100%';
                        iframe.style.height = '100%';
                        slideMedia.appendChild(iframe);
                    }
                }
            }

            currentSlideEl.textContent = currentSlideIndex + 1;
        }

        function extractYouTubeId(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function showPrevSlide() {
            if (currentSlideIndex > 0) {
                currentSlideIndex--;
                updateSlideDisplay();
            }
        }

        function showNextSlide() {
            if (currentSlideIndex < generatedSlides.length - 1) {
                currentSlideIndex++;
                updateSlideDisplay();
            }
        }

        function downloadPresentation() {
            if (!presentationData || generatedSlides.length === 0) {
                alert("Please generate a presentation first!");
                return;
            }

            // Create a new presentation
            const pptx = new PptxGenJS();
            pptx.author = "SlidesAI.io";
            pptx.title = presentationData.title;
            pptx.company = "AI Presentation Tools";

            // Set layout for all slides
            pptx.layout = 'LAYOUT_16x9';

            // Add slides with proper positioning
            presentationData.slides.forEach((slide, index) => {
                const style = styleTemplates[slide.style] || styleTemplates.professional;
                const pptxSlide = pptx.addSlide();

                // Set background
                pptxSlide.background = { color: style.bgColor };

                // Add title with proper positioning
                pptxSlide.addText(slide.title, {
                    x: slide.type === "title" ? 0 : 0.5,
                    y: slide.type === "title" ? 1.5 : 0.5,
                    w: slide.type === "title" ? '100%' : '90%',
                    h: 1.5,
                    fontSize: style.titleSize,
                    bold: true,
                    color: style.titleColor,
                    fontFace: style.font,
                    align: slide.type === "title" ? "center" : "left"
                });

                // Add content with proper positioning
                let yPos = slide.type === "title" ? 3.0 : 1.5;
                slide.content.forEach((point, i) => {
                    pptxSlide.addText(point, {
                        x: slide.type === "title" ? 0.5 : 1.0,
                        y: yPos,
                        w: slide.type === "title" ? '90%' : '85%',
                        fontSize: style.textSize,
                        color: style.textColor,
                        fontFace: style.font,
                        align: slide.type === "title" ? "center" : "left",
                        bullet: slide.type === "title" ? false : { code: "25CF", color: style.bulletColor }
                    });
                    yPos += 0.6; // Increment vertical position with more space
                });

                // Add footer
                pptxSlide.addText(`Slide ${index + 1} of ${presentationData.slides.length}`, {
                    x: 7.0,
                    y: 6.5,
                    w: 2.0,
                    fontSize: 12,
                    color: style.textColor,
                    fontFace: style.font
                });

                // Add logo for title slide
                if (slide.type === "title") {
                    pptxSlide.addText("SlidesAI.io", {
                        x: "50%",
                        y: 6.0,
                        w: "100%",
                        fontSize: 18,
                        color: style.textColor,
                        fontFace: style.font,
                        align: "center"
                    });
                }

                // Add media to slide (images only for PPTX)
                if (slide.media && slide.media.type === 'image') {
                    try {
                        pptxSlide.addImage({
                            data: slide.media.source,
                            x: 5.0,
                            y: 2.0,
                            w: 3.0,
                            h: 3.0
                        });
                    } catch (e) {
                        console.error("Error adding image to slide:", e);
                    }
                }
            });

            // Download the presentation
            pptx.writeFile({ fileName: `${presentationData.title.replace(/[^a-z0-9]/gi, '_')}.pptx` })
                .then(() => {
                    // Show notification
                    saveNotification.classList.add('show');
                    setTimeout(() => saveNotification.classList.remove('show'), 5000);
                })
                .catch(err => {
                    console.error("Error generating PPTX:", err);
                    alert("Failed to generate presentation file. Please try again.");
                });
        }

        // Initialize
        totalSlidesEl.textContent = "0";
        currentSlideEl.textContent = "0";
    </script>
</body>

</html>