<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SlidesAI.io Presentation Generator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.11.0/dist/pptxgen.bundle.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f1a3d, #2a0c3d, #0f1a3d);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 0;
            background: rgba(15, 25, 60, 0.7);
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(106, 90, 205, 0.3);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(106, 90, 205, 0.3), transparent 70%);
            z-index: -1;
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            background: linear-gradient(to right, #6a5acd, #9370db);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            font-size: 1.2rem;
            color: #a0a0e0;
            max-width: 700px;
            margin: 0 auto 30px;
        }

        .main-content {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
        }

        .input-section {
            flex: 1;
            background: rgba(20, 25, 50, 0.7);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(106, 90, 205, 0.3);
        }

        .preview-section {
            flex: 1;
            background: rgba(20, 25, 50, 0.7);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(106, 90, 205, 0.3);
            display: flex;
            flex-direction: column;
        }

        .section-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .section-header h2 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: #9370db;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #a0a0e0;
        }

        input,
        textarea,
        select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(40, 40, 80, 0.5);
            border: 1px solid rgba(106, 90, 205, 0.3);
            border-radius: 8px;
            color: #fff;
            font-size: 1rem;
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        .btn {
            padding: 16px 40px;
            background: linear-gradient(45deg, #6a5acd, #9370db);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 5px 20px rgba(106, 90, 205, 0.5);
            width: 100%;
            justify-content: center;
        }

        .btn:hover {
            background: linear-gradient(45deg, #5a4acd, #8360db);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(106, 90, 205, 0.7);
        }

        .btn i {
            font-size: 1.2rem;
        }

        .image-upload {
            border: 2px dashed rgba(106, 90, 205, 0.5);
            border-radius: 8px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .image-upload:hover {
            border-color: #6a5acd;
            background: rgba(40, 40, 80, 0.3);
        }

        .image-upload i {
            font-size: 3rem;
            color: #9370db;
            margin-bottom: 15px;
        }

        .image-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }

        .preview-image {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            object-fit: cover;
            border: 2px solid #6a5acd;
        }

        .preview-container {
            flex: 1;
            background: #111;
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            min-height: 400px;
        }

        .slide-nav {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 15px;
        }

        .slide-nav-btn {
            background: rgba(40, 40, 80, 0.5);
            color: #ccc;
            border: none;
            border-radius: 8px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .slide-nav-btn:hover {
            background: linear-gradient(45deg, #6a5acd, #9370db);
            color: white;
        }

        .slide-counter {
            display: flex;
            align-items: center;
            font-size: 1rem;
            color: #a0a0e0;
        }

        .download-section {
            margin-top: 20px;
            text-align: center;
        }

        .save-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(40, 167, 69, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            transform: translateX(200%);
            transition: transform 0.3s ease;
        }

        .save-notification.show {
            transform: translateX(0);
        }

        .save-notification i {
            font-size: 1.5rem;
        }

        .generating-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 20, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        .generating-overlay.hidden {
            display: none;
        }

        .generating-overlay i {
            font-size: 3rem;
            color: #6a5acd;
            margin-bottom: 20px;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }

            100% {
                transform: scale(1);
            }
        }

        .preview-placeholder {
            text-align: center;
            color: #a0a0e0;
            padding: 20px;
        }

        .preview-placeholder i {
            font-size: 5rem;
            margin-bottom: 20px;
            color: #6a5acd;
        }

        .slide-svg {
            width: 100%;
            height: 100%;
            background-color: white;
        }

        .slide-preview {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: white;
        }

        .style-preview {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            justify-content: center;
        }

        .style-preview-item {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .style-preview-item.active {
            border-color: white;
        }

        .professional-bg {
            background: linear-gradient(45deg, #1E3A8A, #3B82F6);
        }

        .creative-bg {
            background: linear-gradient(45deg, #6A5ACD, #9370DB);
        }

        .minimalist-bg {
            background: linear-gradient(45deg, #4B5563, #9CA3AF);
        }

        .tech-bg {
            background: linear-gradient(45deg, #0F766E, #14B8A6);
        }

        footer {
            text-align: center;
            padding: 40px 0 20px;
            margin-top: 40px;
            color: #a0a0e0;
            font-size: 0.9rem;
            border-top: 1px solid rgba(106, 90, 205, 0.3);
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }

            h1 {
                font-size: 2.2rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>SlidesAI.io Presentation Generator</h1>
            <p class="subtitle">Create stunning presentations with AI - directly on this page</p>
        </header>

        <div class="main-content">
            <div class="input-section">
                <div class="section-header">
                    <h2>Create Your Presentation</h2>
                    <p>Enter your content and let AI generate your slides</p>
                </div>

                <div class="form-group">
                    <label for="presentation-title"><i class="fas fa-heading"></i> Presentation Title</label>
                    <input type="text" id="presentation-title" placeholder="Enter presentation title"
                        value="Future of AI in Business">
                </div>

                <div class="form-group">
                    <label for="presentation-topic"><i class="fas fa-lightbulb"></i> Presentation Topic</label>
                    <textarea id="presentation-topic"
                        placeholder="Describe what your presentation should be about">Artificial Intelligence is transforming business operations across all industries. This presentation should cover key applications, benefits, challenges, and future trends of AI in business. Focus on real-world examples from finance, healthcare, and manufacturing.</textarea>
                </div>

                <div class="form-group">
                    <label for="slide-count"><i class="fas fa-layer-group"></i> Number of Slides</label>
                    <select id="slide-count">
                        <option value="5">5 Slides</option>
                        <option value="10" selected>10 Slides</option>
                        <option value="15">15 Slides</option>
                        <option value="20">20 Slides</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="presentation-style"><i class="fas fa-palette"></i> Presentation Style</label>
                    <select id="presentation-style">
                        <option value="professional">Professional</option>
                        <option value="creative">Creative</option>
                        <option value="minimalist">Minimalist</option>
                        <option value="tech">Tech-Inspired</option>
                    </select>
                    <div class="style-preview">
                        <div class="style-preview-item professional-bg active" data-style="professional"></div>
                        <div class="style-preview-item creative-bg" data-style="creative"></div>
                        <div class="style-preview-item minimalist-bg" data-style="minimalist"></div>
                        <div class="style-preview-item tech-bg" data-style="tech"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-image"></i> Add Images (Optional)</label>
                    <div class="image-upload" id="image-upload">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Drag & drop images here or click to browse</p>
                        <input type="file" id="file-input" accept="image/*" multiple style="display: none;">
                    </div>
                    <div class="image-preview" id="image-preview"></div>
                </div>

                <button class="btn" id="generate-btn">
                    <i class="fas fa-magic"></i> Generate Presentation
                </button>
            </div>

            <div class="preview-section">
                <div class="section-header">
                    <h2>Presentation Preview</h2>
                    <p>Your AI-generated slides will appear here</p>
                </div>

                <div class="preview-container">
                    <div class="generating-overlay hidden" id="generating-overlay">
                        <i class="fas fa-spinner"></i>
                        <h3>Generating Your Presentation</h3>
                        <p>This usually takes 5-10 seconds...</p>
                    </div>

                    <div class="preview-placeholder" id="preview-placeholder">
                        <i class="fas fa-file-powerpoint"></i>
                        <h3>No Presentation Generated Yet</h3>
                        <p>Click "Generate Presentation" to create your slides</p>
                    </div>

                    <div id="slide-container" class="hidden">
                        <svg class="slide-svg" id="slide-svg" viewBox="0 0 800 450"></svg>
                    </div>
                </div>

                <div class="slide-nav">
                    <button class="slide-nav-btn" id="prev-slide">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="slide-counter">
                        <span id="current-slide">0</span> / <span id="total-slides">0</span>
                    </div>
                    <button class="slide-nav-btn" id="next-slide">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>

                <div class="download-section">
                    <button class="btn" id="download-btn">
                        <i class="fas fa-download"></i> Download Presentation
                    </button>
                </div>
            </div>
        </div>

        <div class="save-notification" id="save-notification">
            <i class="fas fa-check-circle"></i>
            <div>
                <h3>Presentation Saved!</h3>
                <p>Check your "Downloads" folder for the file</p>
            </div>
        </div>

        <footer>
            <p>Integrated SlidesAI.io Solution | Seamless Presentation Generation</p>
            <p>Â© 2023 AI Presentation Tools. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // DOM Elements
        const imageUpload = document.getElementById('image-upload');
        const fileInput = document.getElementById('file-input');
        const imagePreview = document.getElementById('image-preview');
        const generateBtn = document.getElementById('generate-btn');
        const generatingOverlay = document.getElementById('generating-overlay');
        const previewPlaceholder = document.getElementById('preview-placeholder');
        const slideSvg = document.getElementById('slide-svg');
        const prevSlideBtn = document.getElementById('prev-slide');
        const nextSlideBtn = document.getElementById('next-slide');
        const currentSlideEl = document.getElementById('current-slide');
        const totalSlidesEl = document.getElementById('total-slides');
        const downloadBtn = document.getElementById('download-btn');
        const saveNotification = document.getElementById('save-notification');
        const slideContainer = document.getElementById('slide-container');
        const stylePreviewItems = document.querySelectorAll('.style-preview-item');

        // State
        let uploadedImages = [];
        let currentSlideIndex = 0;
        let generatedSlides = [];
        let presentationData = null;

        // Style templates
        const styleTemplates = {
            professional: {
                bgColor: '#1E3A8A',
                titleColor: '#FFFFFF',
                textColor: '#FFFFFF',
                accentColor: '#3B82F6',
                font: 'Arial, sans-serif',
                titleSize: 36,
                textSize: 20,
                bulletColor: '#3B82F6'
            },
            creative: {
                bgColor: '#6A5ACD',
                titleColor: '#FFFFFF',
                textColor: '#F0F8FF',
                accentColor: '#9370DB',
                font: 'Georgia, serif',
                titleSize: 40,
                textSize: 22,
                bulletColor: '#FFD700'
            },
            minimalist: {
                bgColor: '#FFFFFF',
                titleColor: '#333333',
                textColor: '#555555',
                accentColor: '#4B5563',
                font: 'Helvetica, sans-serif',
                titleSize: 32,
                textSize: 18,
                bulletColor: '#9CA3AF'
            },
            tech: {
                bgColor: '#0F172A',
                titleColor: '#0EA5E9',
                textColor: '#E2E8F0',
                accentColor: '#14B8A6',
                font: 'Consolas, monospace',
                titleSize: 34,
                textSize: 18,
                bulletColor: '#14B8A6'
            }
        };

        // Event Listeners
        imageUpload.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', (e) => {
            const files = e.target.files;
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        uploadedImages.push(event.target.result);
                        updateImagePreview();
                    };
                    reader.readAsDataURL(file);
                }
            }
        });

        generateBtn.addEventListener('click', generatePresentation);
        prevSlideBtn.addEventListener('click', showPrevSlide);
        nextSlideBtn.addEventListener('click', showNextSlide);
        downloadBtn.addEventListener('click', downloadPresentation);

        // Style preview selection
        stylePreviewItems.forEach(item => {
            item.addEventListener('click', () => {
                stylePreviewItems.forEach(i => i.classList.remove('active'));
                item.classList.add('active');
                document.getElementById('presentation-style').value = item.dataset.style;
            });
        });

        // Functions
        function updateImagePreview() {
            imagePreview.innerHTML = '';
            uploadedImages.forEach(imgSrc => {
                const img = document.createElement('img');
                img.src = imgSrc;
                img.classList.add('preview-image');
                imagePreview.appendChild(img);
            });
        }

        function generatePresentation() {
            // Get form values
            const title = document.getElementById('presentation-title').value;
            const topic = document.getElementById('presentation-topic').value;
            const slideCount = parseInt(document.getElementById('slide-count').value);
            const style = document.getElementById('presentation-style').value;

            // Validate input
            if (!title.trim() || !topic.trim()) {
                alert('Please enter a title and topic for your presentation');
                return;
            }

            // Show generating overlay
            generatingOverlay.classList.remove('hidden');
            previewPlaceholder.classList.add('hidden');
            slideContainer.classList.add('hidden');

            // Generate presentation structure
            presentationData = generatePresentationStructure(title, topic, slideCount, style);

            // Simulate processing time
            setTimeout(() => {
                generatedSlides = presentationData.slides;

                // Update UI
                generatingOverlay.classList.add('hidden');
                previewPlaceholder.classList.add('hidden');
                slideContainer.classList.remove('hidden');

                // Show first slide
                currentSlideIndex = 0;
                updateSlideDisplay();

                // Update slide counter
                totalSlidesEl.textContent = generatedSlides.length;
            }, 1500);
        }

        function generatePresentationStructure(title, topic, slideCount, style) {
            // Generate slide content based on topic
            const slides = [];

            // Title slide
            slides.push({
                title: title,
                content: [
                    `Topic: ${topic}`,
                    `Generated on: ${new Date().toLocaleDateString()}`,
                    "Created with SlidesAI.io"
                ],
                type: "title",
                style: style
            });

            // Content slides
            const contentPoints = [
                "Introduction to the topic",
                "Key concepts and definitions",
                "Current trends and developments",
                "Benefits and advantages",
                "Challenges and limitations",
                "Case studies and examples",
                "Implementation strategies",
                "Future outlook and predictions",
                "Recommendations and best practices",
                "Conclusion and summary"
            ];

            for (let i = 1; i < slideCount; i++) {
                const slideTitle = contentPoints[Math.min(i - 1, contentPoints.length - 1)];
                const content = generateSlideContent(topic, slideTitle, i);

                slides.push({
                    title: slideTitle,
                    content: content,
                    type: i === slideCount - 1 ? "conclusion" : "content",
                    style: style
                });
            }

            return {
                title: title,
                topic: topic,
                slides: slides,
                style: style,
                generatedAt: new Date()
            };
        }

        function generateSlideContent(topic, slideTitle, slideIndex) {
            const contentPoints = [];
            const pointCount = 3 + Math.floor(Math.random() * 3); // 3-5 points

            for (let i = 0; i < pointCount; i++) {
                contentPoints.push(generateContentPoint(topic, slideTitle, slideIndex, i));
            }

            return contentPoints;
        }

        function generateContentPoint(topic, slideTitle, slideIndex, pointIndex) {
            const verbs = ["Implement", "Develop", "Utilize", "Optimize", "Streamline", "Enhance", "Transform"];
            const nouns = ["processes", "systems", "solutions", "strategies", "technologies", "approaches", "frameworks"];
            const adjectives = ["AI-driven", "efficient", "scalable", "innovative", "robust", "adaptive", "intelligent"];

            const verb = verbs[Math.floor(Math.random() * verbs.length)];
            const noun = nouns[Math.floor(Math.random() * nouns.length)];
            const adjective = adjectives[Math.floor(Math.random() * adjectives.length)];

            return `${verb} ${adjective} ${noun} for ${topic.toLowerCase()} ${pointIndex % 2 === 0 ? 'improves outcomes' : 'reduces costs'}`;
        }

        function updateSlideDisplay() {
            if (generatedSlides.length === 0) return;

            const slide = generatedSlides[currentSlideIndex];
            const style = styleTemplates[slide.style] || styleTemplates.professional;
            slideSvg.innerHTML = '';

            // Create SVG slide background
            const bg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            bg.setAttribute('width', '100%');
            bg.setAttribute('height', '100%');
            bg.setAttribute('fill', style.bgColor);
            slideSvg.appendChild(bg);

            // Add decorative elements based on style
            if (slide.style === 'professional') {
                const accentBar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                accentBar.setAttribute('x', '0');
                accentBar.setAttribute('y', '0');
                accentBar.setAttribute('width', '100%');
                accentBar.setAttribute('height', '15');
                accentBar.setAttribute('fill', style.accentColor);
                slideSvg.appendChild(accentBar);

                const footerBar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                footerBar.setAttribute('x', '0');
                footerBar.setAttribute('y', '435');
                footerBar.setAttribute('width', '100%');
                footerBar.setAttribute('height', '15');
                footerBar.setAttribute('fill', style.accentColor);
                slideSvg.appendChild(footerBar);
            }
            else if (slide.style === 'creative') {
                const circle1 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle1.setAttribute('cx', '700');
                circle1.setAttribute('cy', '50');
                circle1.setAttribute('r', '50');
                circle1.setAttribute('fill', style.accentColor);
                circle1.setAttribute('opacity', '0.3');
                slideSvg.appendChild(circle1);

                const circle2 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle2.setAttribute('cx', '50');
                circle2.setAttribute('cy', '400');
                circle2.setAttribute('r', '70');
                circle2.setAttribute('fill', style.accentColor);
                circle2.setAttribute('opacity', '0.2');
                slideSvg.appendChild(circle2);
            }
            else if (slide.style === 'tech') {
                // Tech pattern
                for (let i = 0; i < 20; i++) {
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    const x1 = Math.random() * 800;
                    const y1 = Math.random() * 450;
                    const x2 = x1 + (Math.random() * 100 - 50);
                    const y2 = y1 + (Math.random() * 100 - 50);
                    line.setAttribute('x1', x1);
                    line.setAttribute('y1', y1);
                    line.setAttribute('x2', x2);
                    line.setAttribute('y2', y2);
                    line.setAttribute('stroke', style.accentColor);
                    line.setAttribute('stroke-width', '0.5');
                    line.setAttribute('opacity', '0.2');
                    slideSvg.appendChild(line);
                }
            }

            // Add title
            const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            title.setAttribute('x', '50');
            title.setAttribute('y', slide.type === "title" ? '150' : '80');
            title.setAttribute('font-size', style.titleSize);
            title.setAttribute('font-weight', 'bold');
            title.setAttribute('fill', style.titleColor);
            title.setAttribute('font-family', style.font);
            title.textContent = slide.title;
            slideSvg.appendChild(title);

            // Add content
            slide.content.forEach((point, index) => {
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', '70');
                text.setAttribute('y', slide.type === "title" ? (200 + index * 40) : (130 + index * 40));
                text.setAttribute('font-size', style.textSize);
                text.setAttribute('fill', style.textColor);
                text.setAttribute('font-family', style.font);

                // Add bullet point
                const bullet = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                bullet.setAttribute('cx', '55');
                bullet.setAttribute('cy', slide.type === "title" ? (200 + index * 40 - 5) : (130 + index * 40 - 5));
                bullet.setAttribute('r', '5');
                bullet.setAttribute('fill', style.bulletColor);
                slideSvg.appendChild(bullet);

                text.textContent = point;
                slideSvg.appendChild(text);
            });

            // Add footer
            const footer = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            footer.setAttribute('x', '700');
            footer.setAttribute('y', '430');
            footer.setAttribute('font-size', '16');
            footer.setAttribute('fill', style.textColor);
            footer.setAttribute('font-family', style.font);
            footer.textContent = `Slide ${currentSlideIndex + 1} of ${generatedSlides.length}`;
            slideSvg.appendChild(footer);

            // Add logo for title slide
            if (slide.type === "title") {
                const logo = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                logo.setAttribute('x', '400');
                logo.setAttribute('y', '400');
                logo.setAttribute('font-size', '24');
                logo.setAttribute('fill', style.textColor);
                logo.setAttribute('font-family', style.font);
                logo.setAttribute('text-anchor', 'middle');
                logo.textContent = "SlidesAI.io";
                slideSvg.appendChild(logo);
            }

            currentSlideEl.textContent = currentSlideIndex + 1;
        }

        function showPrevSlide() {
            if (currentSlideIndex > 0) {
                currentSlideIndex--;
                updateSlideDisplay();
            }
        }

        function showNextSlide() {
            if (currentSlideIndex < generatedSlides.length - 1) {
                currentSlideIndex++;
                updateSlideDisplay();
            }
        }

        function downloadPresentation() {
            if (!presentationData || generatedSlides.length === 0) {
                alert("Please generate a presentation first!");
                return;
            }

            // Create a new presentation
            const pptx = new PptxGenJS();
            pptx.author = "SlidesAI.io";
            pptx.title = presentationData.title;
            pptx.company = "AI Presentation Tools";

            // Set layout for all slides
            pptx.layout = 'LAYOUT_16x9';

            // Add slides with proper positioning
            presentationData.slides.forEach((slide, index) => {
                const style = styleTemplates[slide.style] || styleTemplates.professional;
                const pptxSlide = pptx.addSlide();

                // Set background
                pptxSlide.background = { color: style.bgColor };

                // Add title
                pptxSlide.addText(slide.title, {
                    x: 0.5,
                    y: slide.type === "title" ? 2.0 : 0.5,
                    w: "90%",
                    h: 1.5,
                    fontSize: style.titleSize,
                    bold: true,
                    color: style.titleColor,
                    fontFace: style.font,
                    align: slide.type === "title" ? "center" : "left"
                });

                // Add content with proper positioning
                let yPos = slide.type === "title" ? 3.0 : 1.5;
                slide.content.forEach((point, i) => {
                    pptxSlide.addText(point, {
                        x: 1.0,
                        y: yPos,
                        w: "85%",
                        fontSize: style.textSize,
                        color: style.textColor,
                        fontFace: style.font,
                        bullet: { code: "25CF", color: style.bulletColor }
                    });
                    yPos += 0.5; // Increment vertical position
                });

                // Add footer
                pptxSlide.addText(`Slide ${index + 1} of ${presentationData.slides.length}`, {
                    x: 7.0,
                    y: 6.5,
                    w: 2.0,
                    fontSize: 12,
                    color: style.textColor,
                    fontFace: style.font
                });

                // Add logo for title slide
                if (slide.type === "title") {
                    pptxSlide.addText("SlidesAI.io", {
                        x: "50%",
                        y: 6.0,
                        w: "100%",
                        fontSize: 18,
                        color: style.textColor,
                        fontFace: style.font,
                        align: "center"
                    });
                }
            });

            // Download the presentation
            pptx.writeFile({ fileName: `${presentationData.title.replace(/[^a-z0-9]/gi, '_')}.pptx` })
                .then(() => {
                    // Show notification
                    saveNotification.classList.add('show');
                    setTimeout(() => saveNotification.classList.remove('show'), 5000);
                })
                .catch(err => {
                    console.error("Error generating PPTX:", err);
                    alert("Failed to generate presentation file. Please try again.");
                });
        }

        // Initialize
        totalSlidesEl.textContent = "0";
        currentSlideEl.textContent = "0";
    </script>
</body>

</html>